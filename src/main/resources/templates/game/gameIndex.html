<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>找 遊 嘻 | RealityRift</title>
  <!-- Favicon
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />-->
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link rel="stylesheet" th:href="@{/css/gameStylesC.css}" />
  <script src="https://kit.fontawesome.com/c3891c01bf.js" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


</head>

<body>
  <!-- Navigation-->
  <nav class="navbar navbar-light bg-light fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#" style="font-family:fantasy"> REALITY RIFT </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
        aria-controls="offcanvasNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Offcanvas</h5>
          <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="offcanvasNavbarDropdown" role="button"
                data-bs-toggle="dropdown" aria-expanded="false">
                Dropdown
              </a>
              <ul class="dropdown-menu" aria-labelledby="offcanvasNavbarDropdown">
                <li><a class="dropdown-item" href="#">Action</a></li>
                <li><a class="dropdown-item" href="#">Another action</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="#">Something else here</a></li>
              </ul>
            </li>
          </ul>
          <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>
        </div>
      </div>
    </div>
  </nav>

  <!-- Header-->
  <header class="bg-dark pt-5">
    <div class="container px-2 px-lg-3 my-1">
      <div class="text-center text-white">
        <h3 class="display-6 fw-bolder"> 哭 咚 咚</h3>
        <p class="lead fw-normal text-white-50 mb-0">- - - - - - - </p>
      </div>
    </div>
  </header><br><br>

  <header class="bg-light">
    <div class="container">
      <div class="accordion">
        <div class="row">
          <div class="col-md-4">
            <div class="row">
              <div class="col-md-12">
                <div class="accordion-item mt-5 mb-3">
                  <h2 class="accordion-header" id="playCityHeading">
                    <button style="color: #ffc107;background-color: #000000f7;" class="accordion-button" type="button"
                      data-bs-toggle="collapse" data-bs-target="#playCityCollapse" aria-expanded="true"
                      aria-controls="playCityCollapse">
                      遊 玩 城 市
                    </button>
                  </h2>
                  <div id="playCityCollapse" class="accordion-collapse collapse show "
                    aria-labelledby="playCityHeading">
                    <div class="accordion-body">
                      <div class="row">

                        <div class="col-sm-4">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="taipei" value="taipei">
                            <label class="form-check-label" for="taipei">台北市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="newtaipei" value="newtaipei">
                            <label class="form-check-label" for="newtaipei">新北市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="taoyuan" value="taoyuan">
                            <label class="form-check-label" for="taoyuan">桃園市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="hsinchu" value="hsinchu">
                            <label class="form-check-label" for="hsinchu">新竹市</label>
                          </div>
                        </div>

                        <div class="col-sm-4">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="taichung" value="taichung">
                            <label class="form-check-label" for="taichung">台中市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="changhua" value="changhua">
                            <label class="form-check-label" for="changhua">彰化縣</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="nantou" value="nantou">
                            <label class="form-check-label" for="nantou">南投縣</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="chiayi" value="chiayi">
                            <label class="form-check-label" for="chiayi">嘉義市</label>
                          </div>
                        </div>

                        <div class="col-sm-4">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="tainan" value="tainan">
                            <label class="form-check-label" for="tainan">台南市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="kaohsiung" value="kaohsiung">
                            <label class="form-check-label" for="kaohsiung">高雄市</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="pingtung" value="pingtung">
                            <label class="form-check-label" for="pingtung">屏東縣</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="yilan" value="yilan">
                            <label class="form-check-label" for="yilan">宜蘭縣</label>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>



          <div class="col-md-4">
            <div class="row">
              <div class="col-md-12">
                <div class="accordion-item mt-5 mb-3">
                  <h2 class="accordion-header" id="levelHeading">
                    <button style="color: #ffc107;background-color: #000000f7;" class="accordion-button" type="button"
                      data-bs-toggle="collapse" data-bs-target="#levelCollapse" aria-expanded="true"
                      aria-controls="levelCollapse">
                      難 度
                    </button>
                  </h2>
                  <div id="levelCollapse" class="accordion-collapse collapse show" aria-labelledby="levelHeading">
                    <div class="accordion-body">
                      <div class="row">
                        <div class="col-sm-4">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="levelFilter" id="beginner"
                              onclick="handleClick(this)">
                            <label class="form-check-label" for="beginner">
                              新手入門
                            </label>
                          </div>
                        </div>
                        <div class="col-sm-4">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="levelFilter" id="intermediate"
                              onclick="handleClick(this)">
                            <label class="form-check-label" for="intermediate">
                              中度玩家
                            </label>
                          </div>
                        </div>
                        <div class="col-sm-4">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="levelFilter" id="advanced"
                              onclick="handleClick(this)">
                            <label class="form-check-label" for="advanced">
                              重度解謎
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <hr>

              <div class="col-md-12">
                <div class="btn-group mb-5 col-12">

                  <div class="col me-3">
                    <button class="btn btn-outline-success dropdown-toggle col-12" type="button" id="playerSelect"
                      data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false">
                      遊 戲 人 數
                    </button>

                    <ul class="dropdown-menu col-6" aria-labelledby="playerSelect">
                      <li><a class="dropdown-item" href="#"> 不 限 </a></li>
                      <li><a class="dropdown-item" href="#">1 - 3 人</a></li>
                      <li><a class="dropdown-item" href="#">4 - 6 人</a></li>
                      <li><a class="dropdown-item" href="#">6 - 8 人</a></li>
                      <li><a class="dropdown-item" href="#">8 人 以 上</a></li>
                    </ul>
                  </div>

                  <div class="col">

                    <button class="btn btn-outline-danger dropdown-toggle col-12" type="button" id="priceSelect"
                      data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false">
                      每 人 預 算
                    </button>

                    <ul class="dropdown-menu col-6" aria-labelledby="priceSelect">
                      <li><a class="dropdown-item" href="#"> 不 限 </a></li>
                      <li><a class="dropdown-item" href="#">$400 以內</a></li>
                      <li><a class="dropdown-item" href="#">$400 ~ $600</a></li>
                      <li><a class="dropdown-item" href="#">$600 ~ $800</a></li>
                      <li><a class="dropdown-item" href="#">$800 ~ $1000</a></li>
                      <li><a class="dropdown-item" href="#">$1000 以上</a></li>
                    </ul>
                  </div>

                </div>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="row">

              <div class="col-12 mb-3">
                <div class="form-check form-switch mt-5 ">
                  <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked" checked>
                  <label class="form-check-label" for="flexSwitchCheckChecked">包含準備中遊戲</label>
                </div>
              </div>
              <div class="col-12">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                  <label class="form-check-label" for="flexSwitchCheckDefault">顯示已謝幕遊戲</label>
                </div>
              </div>

            </div>
            <hr>


            <div class="MuiAutocomplete-root" role="combobox" aria-expanded="false" style="width: 100%;">
              <label
                class="MuiFormLabel-root MuiInputLabel-root MuiInputLabel-formControl MuiInputLabel-animated MuiInputLabel-marginDense MuiInputLabel-outlined"
                data-shrink="false" for="title-suggestion" id="title-suggestion-label">ㄗㄗㄗ</label>
              <div class="MuiInputBase-root ">
                <input aria-invalid="false" autocomplete="off" id="title-suggestion" placeholder="ㄕㄖㄍㄐㄗ (選填)"
                  type="text" class="MuiInputBase-input " aria-autocomplete="list" autocapitalize="none"
                  spellcheck="false" value="">
              </div>
            </div>

          </div>

          <div class="col-md-1">
            <div class="row">
              <div class="col-12 mt-5 mb-5">
                <button type="reset" class="btn btn-outline-dark">重 設</button>
              </div>

              <div class="col-12 mt-5 mb-5">
                <button type="button" class="btn btn-outline-info ">搜 尋</button>
              </div>
            </div>
          </div>

        </div>
      </div>

  </header>

  <!-- Section-->
  <section class="py-5">
    <div class="container px-4 px-lg-3 mt-5">
      <div class="row gx-lg-4 row-cols-xl-4 justify-content-center" id="gameContainer">

        <th:block th:each=" eachgame,iter : ${games}">

          <div class="col mb-5">
            <div class="card h-100">
              <!-- Product image-->
              <img class="card-img-top" th:src="${'/rr/'+eachgame.gameimg}" th:id="'img'+${eachgame.gameid}"
                style="width: 100%; height:250px" />
              <!-- Product details-->
              <div class="card-body p-4">
                <div class="text-center">
                  <!-- Product name-->
                  <h5 class="fw-bolder"><span th:text="${eachgame.gname}"></span></h5>
                  <!-- Product price-->
                  $$
                </div>
              </div>
              <!-- Product actions-->
              <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                <div class="text-center"><a class="btn btn-outline-dark mt-auto"
                    th:href="@{/game/view(gameid=${eachgame.gameid})}">View options</a></div>
              </div>
            </div>
          </div>

        </th:block>





      </div>
    </div>
  </section>
  <!-- Footer-->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; 實境裂谷 2023</p>
    </div>
  </footer>
  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Core theme JS-->
  <script th:src="@{/js/gameScriptsC.js}"></script>

  <script>
    //選城市
    $(document).ready(function () {
      var maxSelection = 3;

      $('#playCityCollapse input[type="checkbox"]').change(function () {
        var selectedCount = $('#playCityCollapse input[type="checkbox"]:checked').length;

        // 超過3 其他設disabled
        $('#playCityCollapse input[type="checkbox"]').each(function () {
          if (selectedCount >= maxSelection && !this.checked) {
            $(this).prop('disabled', true);
          } else {
            $(this).prop('disabled', false);
          }
        });
      });
    });


    //選難度
    // var lastChecked = null;

    // function handleClick(element) {
    //   var radioButtons = document.getElementsByName("levelFilter");

    //   // 再點一下反選
    //   if (element === lastChecked) {
    //     element.checked = false;
    //     lastChecked = null;

    //     // 解除其他選項disabled
    //     for (var i = 0; i < radioButtons.length; i++) {
    //       radioButtons[i].disabled = false;
    //     }
    //   } else {
    //     lastChecked = element;

    //     for (var i = 0; i < radioButtons.length; i++) {
    //       if (radioButtons[i] !== element) {
    //         radioButtons[i].disabled = true;
    //       }
    //     }
    //   }
    // }


    //人數選單
    $(document).ready(function () {
      $('#playerSelect + .dropdown-menu .dropdown-item').click(function () {
        var selectedText = $(this).text();
        $('#playerSelect').text(selectedText);
      });

      // 預算選單
      $('#priceSelect + .dropdown-menu .dropdown-item').click(function () {
        var selectedText = $(this).text();
        $('#priceSelect').text(selectedText);
      });
    });


  // 選難度
  var lastChecked = null;

  function handleClick(element) {
    var radioButtons = document.getElementsByName("levelFilter");

    // 再點一次反選
    if (element === lastChecked) {
      element.checked = false;
      lastChecked = null;

      // 解除其他disabled
      radioButtons.forEach(function(button) {
        button.disabled = false;
      });
    } else {
      lastChecked = element;

      radioButtons.forEach(function(button) {
        if (button !== element) {
          button.disabled = true;
        }
      });
    }

    // 取得難度
    var level = "";
    if (element.id === "beginner") {
      level = "新手入門";
    } else if (element.id === "intermediate") {
      level = "中度玩家";
    } else if (element.id === "advanced") {
      level = "重度解謎";
    }

    // 发起 Ajax 请求获取对应难度级别的游戏数据
    getGamesByLevel(level);
  }

  function getGamesByLevel(level) {
    // 发起 Ajax 请求
    $.ajax({
      url: "/rr/Index/level",
      type: "GET",
      data: {
        level: level
      },
      success: function(response) {
        // 清空游戏容器
        $("#gameContainer").empty();

        // 循环遍历游戏数据并动态添加游戏卡片
        response.forEach(function(game) {
          var gameCard = `
            <div class="col mb-5">
              <div class="card h-100">
                <img class="card-img-top" src="/rr/${game.gameimg}" id="img${game.gameid}" style="width: 100%; height:250px">
                <div class="card-body p-4">
                  <div class="text-center">
                    <h5 class="fw-bolder">${game.gname}</h5>
                    $$
                  </div>
                </div>
                <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                  <div class="text-center">
                    <a class="btn btn-outline-dark mt-auto" href="/rr/game/view?gameid=${game.gameid}">View options</a>
                  </div>
                </div>
              </div>
            </div>
          `;
          $("#gameContainer").append(gameCard);
        });
      },
      error: function(error) {
        console.log("Ajax request failed: ", error);
      }
    });
  }


  </script>
</body>

</html>